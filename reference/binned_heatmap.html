<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot Binned Heatmap — binned_heatmap • ecokit</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot Binned Heatmap — binned_heatmap"><meta name="description" content="Creates a tile-binned frequency heatmap of two variables using rasterization
for efficient handling of large datasets. The function supports log10
transformations for axes and fill scale, and allows customization of axis
labels, title, and subtitle. The function can be useful to visualize the
distribution and density of points in a two-dimensional space, especially for
large datasets where traditional scatter plots may become cluttered. It can
help identify patterns, clusters, and outliers in the data."><meta property="og:description" content="Creates a tile-binned frequency heatmap of two variables using rasterization
for efficient handling of large datasets. The function supports log10
transformations for axes and fill scale, and allows customization of axis
labels, title, and subtitle. The function can be useful to visualize the
distribution and density of points in a two-dimensional space, especially for
large datasets where traditional scatter plots may become cluttered. It can
help identify patterns, clusters, and outliers in the data."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ecokit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> Functions</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/elgabbas/ecokit/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot Binned Heatmap</h1>
      <small class="dont-index">Source: <a href="https://github.com/elgabbas/ecokit/blob/main/R/plot_heatmap.R" class="external-link"><code>R/plot_heatmap.R</code></a></small>
      <div class="d-none name"><code>binned_heatmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates a tile-binned frequency heatmap of two variables using rasterization
for efficient handling of large datasets. The function supports <code>log10</code>
transformations for axes and fill scale, and allows customization of axis
labels, title, and subtitle. The function can be useful to visualize the
distribution and density of points in a two-dimensional space, especially for
large datasets where traditional scatter plots may become cluttered. It can
help identify patterns, clusters, and outliers in the data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">binned_heatmap</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  ncol <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  log_x <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  log_y <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  log_fill <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  xlab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subtitle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_breaks <span class="op">=</span> <span class="fl">6L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame containing the variables to plot.</p></dd>


<dt id="arg-x-y">x, y<a class="anchor" aria-label="anchor" href="#arg-x-y"></a></dt>
<dd><p>Character string specifying the column name for the x and y-axis
variables.</p></dd>


<dt id="arg-nrow-ncol">nrow, ncol<a class="anchor" aria-label="anchor" href="#arg-nrow-ncol"></a></dt>
<dd><p>Integer specifying the number of rows and columns in the
raster grid (default: 100).</p></dd>


<dt id="arg-log-x-log-y">log_x, log_y<a class="anchor" aria-label="anchor" href="#arg-log-x-log-y"></a></dt>
<dd><p>Logical indicating whether to apply log10 transformation
to x and y axes (default: FALSE).</p></dd>


<dt id="arg-log-fill">log_fill<a class="anchor" aria-label="anchor" href="#arg-log-fill"></a></dt>
<dd><p>Logical indicating whether to use log10 scale for the fill
(default: FALSE).</p></dd>


<dt id="arg-xlab-ylab">xlab, ylab<a class="anchor" aria-label="anchor" href="#arg-xlab-ylab"></a></dt>
<dd><p>Character string for the x and y axis label (default:
<code>NULL</code>).</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>Character string for the plot title (default: <code>NULL</code>).</p></dd>


<dt id="arg-subtitle">subtitle<a class="anchor" aria-label="anchor" href="#arg-subtitle"></a></dt>
<dd><p>Character string for the plot subtitle (default: <code>NULL</code>).</p></dd>


<dt id="arg-n-breaks">n_breaks<a class="anchor" aria-label="anchor" href="#arg-n-breaks"></a></dt>
<dd><p>Integer specifying the approximate number of breaks for axes
and colour bar (default: 6).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggplot2 object representing the heatmap.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ahmed El-Gabbas</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Bivariate Normal Data (No Skew)</span></span></span>
<span class="r-in"><span><span class="co"># ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">binned_heatmap</span><span class="op">(</span><span class="va">df_norm</span>, x <span class="op">=</span> <span class="st">"x"</span>, y <span class="op">=</span> <span class="st">"y"</span>, title <span class="op">=</span> <span class="st">"Bivariate Normal"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="binned_heatmap-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Strongly Right-Skewed (Log-Normal)</span></span></span>
<span class="r-in"><span><span class="co"># ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df_lognorm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="va">n</span>, meanlog <span class="op">=</span> <span class="fl">1</span>, sdlog <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="va">n</span>, meanlog <span class="op">=</span> <span class="fl">2</span>, sdlog <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">binned_heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">df_lognorm</span>, x <span class="op">=</span> <span class="st">"x"</span>, y <span class="op">=</span> <span class="st">"y"</span>,</span></span>
<span class="r-in"><span>  title <span class="op">=</span> <span class="st">"Bivariate Log-Normal"</span>, log_fill <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="binned_heatmap-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Left- and Right-Skewed (Beta Shapes)</span></span></span>
<span class="r-in"><span><span class="co"># ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">n</span>, shape1 <span class="op">=</span> <span class="fl">2</span>, shape2 <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">n</span>, shape1 <span class="op">=</span> <span class="fl">7</span>, shape2 <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">binned_heatmap</span><span class="op">(</span><span class="va">df_beta</span>, x <span class="op">=</span> <span class="st">"x"</span>, y <span class="op">=</span> <span class="st">"y"</span>, title <span class="op">=</span> <span class="st">"Mixed Skewness (Beta)"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="binned_heatmap-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Strong Bimodal Data</span></span></span>
<span class="r-in"><span><span class="co"># ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x_bimodal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="fl">2</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y_bimodal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="fl">2</span>, <span class="op">-</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df_bimodal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_bimodal</span>, y <span class="op">=</span> <span class="va">y_bimodal</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">binned_heatmap</span><span class="op">(</span><span class="va">df_bimodal</span>, x <span class="op">=</span> <span class="st">"x"</span>, y <span class="op">=</span> <span class="st">"y"</span>, title <span class="op">=</span> <span class="st">"Bimodal Distribution"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="binned_heatmap-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Clustered Data (Two Clusters, One Skewed)</span></span></span>
<span class="r-in"><span><span class="co"># ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n_ct1</span> <span class="op">&lt;-</span> <span class="fl">6000</span></span></span>
<span class="r-in"><span><span class="va">n_ct2</span> <span class="op">&lt;-</span> <span class="fl">4000</span></span></span>
<span class="r-in"><span><span class="va">df_clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_ct1</span>, <span class="fl">2</span>, <span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="va">n_ct2</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span> <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_ct1</span>, <span class="fl">2</span>, <span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="va">n_ct2</span>, <span class="fl">1</span>, <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">binned_heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">df_clusters</span>, x <span class="op">=</span> <span class="st">"x"</span>, y <span class="op">=</span> <span class="st">"y"</span>,</span></span>
<span class="r-in"><span>  title <span class="op">=</span> <span class="st">"Clusters: Gaussian &amp; Skewed"</span>,</span></span>
<span class="r-in"><span>  subtitle <span class="op">=</span> <span class="st">"Left = normal, Right = lognormal-skewed"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="binned_heatmap-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Uniform Data (No Skew or Clustering)</span></span></span>
<span class="r-in"><span><span class="co"># ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df_uniform</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">binned_heatmap</span><span class="op">(</span><span class="va">df_uniform</span>, x <span class="op">=</span> <span class="st">"x"</span>, y <span class="op">=</span> <span class="st">"y"</span>, title <span class="op">=</span> <span class="st">"Bivariate Uniform"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="binned_heatmap-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Example using dismo bioclimatic variables</span></span></span>
<span class="r-in"><span><span class="co"># ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plotting frequency heatmaps of bioclimatic variables from the dismo package</span></span></span>
<span class="r-in"><span><span class="fu">ecokit</span><span class="fu">::</span><span class="fu"><a href="load_packages.html">load_packages</a></span><span class="op">(</span><span class="va">dplyr</span>, <span class="va">dismo</span>, <span class="va">terra</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">predictors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"dismo"</span><span class="op">)</span>, <span class="st">"/ex"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  pattern <span class="op">=</span> <span class="st">"grd"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span>xy <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">predictors</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 9</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    bio1 bio12 bio16 bio17  bio5  bio6  bio7  bio8 biome</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>   113  <span style="text-decoration: underline;">1</span>800   936    32   242    24   218    73     5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>   112  <span style="text-decoration: underline;">1</span>556   810    27   265    10   255    66     5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>   112  <span style="text-decoration: underline;">1</span>263   662    24   302   -<span style="color: #BB0000;">14</span>   316    53     5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>   110  <span style="text-decoration: underline;">1</span>049   532    26   301   -<span style="color: #BB0000;">19</span>   319    49     5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>   161   532   276    16   351    19   332    81     8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>   153   855   438    19   340    16   324    76     8</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">binned_heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">predictors</span>, x <span class="op">=</span> <span class="st">"bio1"</span>, y <span class="op">=</span> <span class="st">"bio17"</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"Annual Mean Temperature (bio1)"</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="st">"Precipitation of Driest Quarter (bio17)"</span>,</span></span>
<span class="r-in"><span>  title <span class="op">=</span> <span class="st">"Heatmap of Bio1 vs Bio17"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in (function (cond) .Internal(C_tryCatchHelper(addr, 1L, cond)))(structure(list(message = structure("Must group by variables found in `.data`.", names = ""),     trace = structure(list(call = list(pkgdown::build_site_github_pages(new_process = FALSE,         install = FALSE), build_site(pkg, preview = FALSE, install = install,         new_process = new_process, ...), build_site_local(pkg = pkg,         examples = examples, run_dont_run = run_dont_run, seed = seed,         lazy = lazy, override = override, preview = preview,         devel = devel, quiet = quiet), build_reference(pkg, lazy = lazy,         examples = examples, run_dont_run = run_dont_run, seed = seed,         override = override, preview = FALSE, devel = devel),         unwrap_purrr_error(purrr::map(topics, build_reference_topic,             pkg = pkg, lazy = lazy, examples_env = examples_env,             run_dont_run = run_dont_run)), withCallingHandlers(code,             purrr_error_indexed = function(err) {                cnd_signal(err$parent)            }), purrr::map(topics, build_reference_topic, pkg = pkg,             lazy = lazy, examples_env = examples_env, run_dont_run = run_dont_run),         map_("list", .x, .f, ..., .progress = .progress), with_indexed_errors(i = i,             names = names, error_call = .purrr_error_call, call_with_cleanup(map_impl,                 environment(), .type, .progress, n, names, i)),         withCallingHandlers(expr, error = function(cnd) {            if (i == 0L) {            }            else {                message &lt;- c(i = "In index: {i}.")                if (!is.null(names) &amp;&amp; !is.na(names[[i]]) &amp;&amp;                   names[[i]] != "") {                  name &lt;- names[[i]]                  message &lt;- c(message, i = "With name: {name}.")                }                else {                  name &lt;- NULL                }                cli::cli_abort(message, location = i, name = name,                   parent = cnd, call = error_call, class = "purrr_error_indexed")            }        }), call_with_cleanup(map_impl, environment(), .type,             .progress, n, names, i), .f(.x[[i]], ...), withCallingHandlers(data_reference_topic(topic,             pkg, examples_env = examples_env, run_dont_run = run_dont_run),             error = function(err) {                cli::cli_abort("Failed to parse Rd in {.file {topic$file_in}}",                   parent = err, call = quote(build_reference()))            }), data_reference_topic(topic, pkg, examples_env = examples_env,             run_dont_run = run_dont_run), run_examples(tags$tag_examples[[1]],             env = if (is.null(examples_env)) NULL else new.env(parent = examples_env),             topic = tools::file_path_sans_ext(topic$file_in),             run_dont_run = run_dont_run), highlight_examples(code,             topic, env = env), downlit::evaluate_and_highlight(code,             fig_save = fig_save_topic, env = eval_env, output_handler = handler),         evaluate::evaluate(code, child_env(env), new_device = TRUE,             output_handler = output_handler), withRestarts(with_handlers({            for (expr in tle$exprs) {                ev &lt;- withVisible(eval(expr, envir))                watcher$capture_plot_and_output()                watcher$print_value(ev$value, ev$visible, envir)            }            TRUE        }, handlers), eval_continue = function() TRUE, eval_stop = function() FALSE),         withRestartList(expr, restarts), withOneRestart(withRestartList(expr,             restarts[-nr]), restarts[[nr]]), doWithOneRestart(return(expr),             restart), withRestartList(expr, restarts[-nr]), withOneRestart(expr,             restarts[[1L]]), doWithOneRestart(return(expr), restart),         with_handlers({            for (expr in tle$exprs) {                ev &lt;- withVisible(eval(expr, envir))                watcher$capture_plot_and_output()                watcher$print_value(ev$value, ev$visible, envir)            }            TRUE        }, handlers), eval(call), eval(call), withCallingHandlers(code,             message = `&lt;fn&gt;`, warning = `&lt;fn&gt;`, error = `&lt;fn&gt;`),         withVisible(eval(expr, envir)), eval(expr, envir), eval(expr,             envir), binned_heatmap(predictors, x = "bio1", y = "bio17",             xlab = "Annual Mean Temperature (bio1)", ylab = "Precipitation of Driest Quarter (bio17)",             title = "Heatmap of Bio1 vs Bio17"), dplyr::mutate(data,             x_bin = (plot_x - min_x)/(max_x - min_x), y_bin = (plot_y -                 min_y)/(max_y - min_y)) %&gt;% dplyr::count(x, y,             plot_x, plot_y, x_bin, y_bin) %&gt;% sf::st_as_sf(coords = c("x_bin",             "y_bin")) %&gt;% terra::vect(), terra::vect(.), sf::st_as_sf(.,             coords = c("x_bin", "y_bin")), dplyr::count(., x,             y, plot_x, plot_y, x_bin, y_bin), count.data.frame(.,             x, y, plot_x, plot_y, x_bin, y_bin), group_by(x,             ..., .add = TRUE, .drop = .drop), group_by.data.frame(x,             ..., .add = TRUE, .drop = .drop), group_by_prepare(.data,             ..., .add = .add, error_call = current_env()), abort(bullets,             call = error_call)), parent = c(0L, 1L, 2L, 3L, 4L,     5L, 4L, 7L, 8L, 9L, 8L, 8L, 12L, 12L, 14L, 15L, 16L, 17L,     18L, 19L, 20L, 21L, 20L, 23L, 24L, 18L, 26L, 27L, 26L, 18L,     18L, 31L, 32L, 33L, 0L, 0L, 0L, 0L, 38L, 38L, 40L, 41L),         visible = c(TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE,         TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE,         TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE,         TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE,         TRUE, TRUE, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE),         namespace = c("pkgdown", "pkgdown", "pkgdown", "pkgdown",         "pkgdown", "base", "purrr", "purrr", "purrr", "base",         "purrr", "pkgdown", "base", "pkgdown", "pkgdown", "pkgdown",         "downlit", "evaluate", "base", "base", "base", "base",         "base", "base", "base", "evaluate", "base", "base", "base",         "base", "base", "base", "ecokit", NA, "terra", "sf",         "dplyr", "dplyr", "dplyr", "dplyr", "dplyr", "rlang"),         scope = c("::", "::", ":::", "::", ":::", "::", "::",         ":::", ":::", "::", ":::", "local", "::", ":::", ":::",         ":::", "::", "::", "::", "local", "local", "local", "local",         "local", "local", ":::", "::", "::", "::", "::", "::",         "::", "::", NA, "::", "::", "::", ":::", "::", ":::",         "::", "::"), error_frame = c(FALSE, FALSE, FALSE, FALSE,         FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,         FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,         FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,         FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,         FALSE, TRUE, FALSE, FALSE, FALSE, FALSE)), row.names = c(NA,     -42L), version = 2L, class = c("rlang_trace", "rlib_trace",     "tbl", "data.frame")), parent = NULL, body = c(x1 = "Column `x` is not found.",     x2 = "Column `y` is not found."), rlang = list(inherit = TRUE),     call = dplyr::count(., x, y, plot_x, plot_y, x_bin, y_bin),     use_cli_format = TRUE), class = c("rlang_error", "error", "condition"))):</span> error in evaluating the argument 'x' in selecting a method for function 'vect': Must group by variables found in `.data`.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> Column `x` is not found.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> Column `y` is not found.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">binned_heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">predictors</span>, x <span class="op">=</span> <span class="st">"bio12"</span>, y <span class="op">=</span> <span class="st">"bio8"</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"Annual Precipitation (bio12)"</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="st">"Mean Temperature of Wettest Quarter (bio8)"</span>,</span></span>
<span class="r-in"><span>  title <span class="op">=</span> <span class="st">"Heatmap of Bio12 vs Bio8"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in (function (cond) .Internal(C_tryCatchHelper(addr, 1L, cond)))(structure(list(message = structure("Must group by variables found in `.data`.", names = ""),     trace = structure(list(call = list(pkgdown::build_site_github_pages(new_process = FALSE,         install = FALSE), build_site(pkg, preview = FALSE, install = install,         new_process = new_process, ...), build_site_local(pkg = pkg,         examples = examples, run_dont_run = run_dont_run, seed = seed,         lazy = lazy, override = override, preview = preview,         devel = devel, quiet = quiet), build_reference(pkg, lazy = lazy,         examples = examples, run_dont_run = run_dont_run, seed = seed,         override = override, preview = FALSE, devel = devel),         unwrap_purrr_error(purrr::map(topics, build_reference_topic,             pkg = pkg, lazy = lazy, examples_env = examples_env,             run_dont_run = run_dont_run)), withCallingHandlers(code,             purrr_error_indexed = function(err) {                cnd_signal(err$parent)            }), purrr::map(topics, build_reference_topic, pkg = pkg,             lazy = lazy, examples_env = examples_env, run_dont_run = run_dont_run),         map_("list", .x, .f, ..., .progress = .progress), with_indexed_errors(i = i,             names = names, error_call = .purrr_error_call, call_with_cleanup(map_impl,                 environment(), .type, .progress, n, names, i)),         withCallingHandlers(expr, error = function(cnd) {            if (i == 0L) {            }            else {                message &lt;- c(i = "In index: {i}.")                if (!is.null(names) &amp;&amp; !is.na(names[[i]]) &amp;&amp;                   names[[i]] != "") {                  name &lt;- names[[i]]                  message &lt;- c(message, i = "With name: {name}.")                }                else {                  name &lt;- NULL                }                cli::cli_abort(message, location = i, name = name,                   parent = cnd, call = error_call, class = "purrr_error_indexed")            }        }), call_with_cleanup(map_impl, environment(), .type,             .progress, n, names, i), .f(.x[[i]], ...), withCallingHandlers(data_reference_topic(topic,             pkg, examples_env = examples_env, run_dont_run = run_dont_run),             error = function(err) {                cli::cli_abort("Failed to parse Rd in {.file {topic$file_in}}",                   parent = err, call = quote(build_reference()))            }), data_reference_topic(topic, pkg, examples_env = examples_env,             run_dont_run = run_dont_run), run_examples(tags$tag_examples[[1]],             env = if (is.null(examples_env)) NULL else new.env(parent = examples_env),             topic = tools::file_path_sans_ext(topic$file_in),             run_dont_run = run_dont_run), highlight_examples(code,             topic, env = env), downlit::evaluate_and_highlight(code,             fig_save = fig_save_topic, env = eval_env, output_handler = handler),         evaluate::evaluate(code, child_env(env), new_device = TRUE,             output_handler = output_handler), withRestarts(with_handlers({            for (expr in tle$exprs) {                ev &lt;- withVisible(eval(expr, envir))                watcher$capture_plot_and_output()                watcher$print_value(ev$value, ev$visible, envir)            }            TRUE        }, handlers), eval_continue = function() TRUE, eval_stop = function() FALSE),         withRestartList(expr, restarts), withOneRestart(withRestartList(expr,             restarts[-nr]), restarts[[nr]]), doWithOneRestart(return(expr),             restart), withRestartList(expr, restarts[-nr]), withOneRestart(expr,             restarts[[1L]]), doWithOneRestart(return(expr), restart),         with_handlers({            for (expr in tle$exprs) {                ev &lt;- withVisible(eval(expr, envir))                watcher$capture_plot_and_output()                watcher$print_value(ev$value, ev$visible, envir)            }            TRUE        }, handlers), eval(call), eval(call), withCallingHandlers(code,             message = `&lt;fn&gt;`, warning = `&lt;fn&gt;`, error = `&lt;fn&gt;`),         withVisible(eval(expr, envir)), eval(expr, envir), eval(expr,             envir), binned_heatmap(predictors, x = "bio12", y = "bio8",             xlab = "Annual Precipitation (bio12)", ylab = "Mean Temperature of Wettest Quarter (bio8)",             title = "Heatmap of Bio12 vs Bio8"), dplyr::mutate(data,             x_bin = (plot_x - min_x)/(max_x - min_x), y_bin = (plot_y -                 min_y)/(max_y - min_y)) %&gt;% dplyr::count(x, y,             plot_x, plot_y, x_bin, y_bin) %&gt;% sf::st_as_sf(coords = c("x_bin",             "y_bin")) %&gt;% terra::vect(), terra::vect(.), sf::st_as_sf(.,             coords = c("x_bin", "y_bin")), dplyr::count(., x,             y, plot_x, plot_y, x_bin, y_bin), count.data.frame(.,             x, y, plot_x, plot_y, x_bin, y_bin), group_by(x,             ..., .add = TRUE, .drop = .drop), group_by.data.frame(x,             ..., .add = TRUE, .drop = .drop), group_by_prepare(.data,             ..., .add = .add, error_call = current_env()), abort(bullets,             call = error_call)), parent = c(0L, 1L, 2L, 3L, 4L,     5L, 4L, 7L, 8L, 9L, 8L, 8L, 12L, 12L, 14L, 15L, 16L, 17L,     18L, 19L, 20L, 21L, 20L, 23L, 24L, 18L, 26L, 27L, 26L, 18L,     18L, 31L, 32L, 33L, 0L, 0L, 0L, 0L, 38L, 38L, 40L, 41L),         visible = c(TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE,         TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE,         TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE,         TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE,         TRUE, TRUE, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE),         namespace = c("pkgdown", "pkgdown", "pkgdown", "pkgdown",         "pkgdown", "base", "purrr", "purrr", "purrr", "base",         "purrr", "pkgdown", "base", "pkgdown", "pkgdown", "pkgdown",         "downlit", "evaluate", "base", "base", "base", "base",         "base", "base", "base", "evaluate", "base", "base", "base",         "base", "base", "base", "ecokit", NA, "terra", "sf",         "dplyr", "dplyr", "dplyr", "dplyr", "dplyr", "rlang"),         scope = c("::", "::", ":::", "::", ":::", "::", "::",         ":::", ":::", "::", ":::", "local", "::", ":::", ":::",         ":::", "::", "::", "::", "local", "local", "local", "local",         "local", "local", ":::", "::", "::", "::", "::", "::",         "::", "::", NA, "::", "::", "::", ":::", "::", ":::",         "::", "::"), error_frame = c(FALSE, FALSE, FALSE, FALSE,         FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,         FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,         FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,         FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,         FALSE, TRUE, FALSE, FALSE, FALSE, FALSE)), row.names = c(NA,     -42L), version = 2L, class = c("rlang_trace", "rlib_trace",     "tbl", "data.frame")), parent = NULL, body = c(x1 = "Column `x` is not found.",     x2 = "Column `y` is not found."), rlang = list(inherit = TRUE),     call = dplyr::count(., x, y, plot_x, plot_y, x_bin, y_bin),     use_cli_format = TRUE), class = c("rlang_error", "error", "condition"))):</span> error in evaluating the argument 'x' in selecting a method for function 'vect': Must group by variables found in `.data`.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> Column `x` is not found.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> Column `y` is not found.</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://elgabbas.netlify.app/" class="external-link">Ahmed El-Gabbas</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

