% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/general_check_data.R
\name{check_data}
\alias{check_data}
\alias{check_rdata}
\alias{check_qs}
\alias{check_rds}
\alias{check_feather}
\title{Check Integrity of Data Files}
\usage{
check_data(file = NULL, warning = TRUE, all_okay = TRUE, n_threads = 1L)

check_rdata(file, warning = TRUE)

check_qs(file, warning = TRUE, n_threads = 1L)

check_rds(file, warning = TRUE)

check_feather(file, warning = TRUE)
}
\arguments{
\item{file}{Character vector. Path to a data file (e.g., \code{.rdata}, \code{.qs2},
\code{.rds}, \code{.feather}).}

\item{warning}{Logical. If \code{TRUE} (default), warnings are issued for invalid
files (e.g., non-existent, wrong extension, or loading failure).}

\item{all_okay}{Logical. If \code{TRUE} (default), returns a single logical output
indicating the integrity of all files; if \code{FALSE}, returns logical vectors
for each file.}

\item{n_threads}{Integer. Number of threads for reading \code{qs2} files. Must be
a positive integer. See \link[qs2:qs_read]{qs2::qs_read} for more details.}
}
\value{
Logical: \code{TRUE} if all checks pass; \code{FALSE} otherwise.
}
\description{
Validates a data file by checking its extension and attempting to load its
contents. A file is considered valid if it exists, is non-empty, has a
supported extension, and loads successfully with a non-null object. Supports
\code{RData}, \code{qs2}, \code{rds}, and \code{feather} file types.
}
\details{
The \code{check_data()} function determines the file type based on its
extension (case-insensitive). If the extension is unrecognised, it returns
\code{FALSE}. Supported file types:
\itemize{
\item \strong{RData}: Checked with \code{check_rdata()}, read using \link{load_as}
\item \strong{qs2}: Checked with \code{check_qs()}, read using \link[qs2:qs_read]{qs2::qs_read}
\item \strong{rds}: Checked with \code{check_rds()}, read using \link{readRDS}
\item \strong{feather}: Checked with \code{check_feather()}, read using
\link[arrow:read_feather]{arrow::read_feather}
}
}
\examples{
require(ecokit)
ecokit::load_packages(fs, arrow)

# Setup temporary directory
temp_dir <- fs::path_temp("load_multiple")
fs::dir_create(temp_dir)

# |||||||||||||||||||||||||||||||||||||||
# Validate RData files
# |||||||||||||||||||||||||||||||||||||||

# valid RData file
data <- data.frame(x = 1:5)
rdata_file <- fs::path(temp_dir, "valid.Rdata")
save(data, file = rdata_file)
check_rdata(rdata_file)

# Invalid RData file (corrupted)
bad_rdata <- fs::path(temp_dir, "invalid.Rdata")
writeLines("not an RData file", bad_rdata)
check_rdata(bad_rdata)
check_rdata(bad_rdata, warning = FALSE)

# |||||||||||||||||||||||||||||||||||||||
# Validate qs2 files
# |||||||||||||||||||||||||||||||||||||||

# Valid qs2 file
qs_file <- fs::path(temp_dir, "valid.qs2")
qs2::qs_save(data, qs_file, nthreads = 1)
check_qs(qs_file, n_threads = 1L)

# Invalid qs2 file (corrupted)
bad_qs <- fs::path(temp_dir, "invalid.qs2")
writeLines("not a qs2 file", bad_qs)
check_qs(bad_qs, n_threads = 1L)
check_qs(bad_qs, n_threads = 1L, warning = FALSE)

# |||||||||||||||||||||||||||||||||||||||
# Validate rds files
# |||||||||||||||||||||||||||||||||||||||

# Valid rds file
rds_file <- fs::path(temp_dir, "valid.rds")
saveRDS(data, rds_file)
check_rds(rds_file)

# Invalid rds file (corrupted)
bad_rds <- fs::path(temp_dir, "invalid.rds")
writeLines("not an rds file", bad_rds)
check_rds(bad_rds)
check_rds(bad_rds, warning = FALSE)

# |||||||||||||||||||||||||||||||||||||||
# Validate feather files
# |||||||||||||||||||||||||||||||||||||||

# Valid feather file
feather_file <- fs::path(temp_dir, "valid.feather")
arrow::write_feather(data, feather_file)
check_feather(feather_file)

# Invalid feather file (corrupted)
bad_feather <- fs::path(temp_dir, "invalid.feather")
writeLines("not a feather file", bad_feather)
check_feather(bad_feather)
check_feather(bad_feather, warning = FALSE)

# |||||||||||||||||||||||||||||||||||||||
# Non-existent file
# |||||||||||||||||||||||||||||||||||||||
check_data("nonexistent.rds")

# |||||||||||||||||||||||||||||||||||||||
# check_data
# |||||||||||||||||||||||||||||||||||||||
all_files <- c(
  rdata_file, bad_rdata, qs_file, bad_qs, rds_file, bad_rds,
  feather_file, bad_feather)
check_data(all_files)
check_data(all_files, all_okay = FALSE)
check_data(all_files, all_okay = FALSE, warning = FALSE)

# clean up
fs::file_delete(all_files)
fs::dir_delete(temp_dir)
}
\author{
Ahmed El-Gabbas
}
